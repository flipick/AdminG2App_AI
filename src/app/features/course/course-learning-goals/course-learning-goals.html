<div class="grid gap-4">
    <div class="section-header">
        <h3 class="section-title">Learning Goals Mapping</h3>
        <p class="section-description">Map this course to specific learning goals to make it discoverable by learners with matching goals</p>
    </div>

    <div class="grid md:grid-cols-2 gap-4">
        <div class="relative">
            <label class="block text-sm font-medium text-gray-700 mb-1">Career Paths</label>
            <div class="select-multiple">
                @for (path of careerPaths; track path.id) {
                <label class="option">
                    <input type="checkbox" 
                           [(ngModel)]="path.isSelected"
                           [ngModelOptions]="{standalone: true}"
                           name="careerPath_{{path.id}}" />
                    <span>{{ path.name }}</span>
                </label>
                }
            </div>
        </div>
        <div class="relative">
            <label class="block text-sm font-medium text-gray-700 mb-1">Target Roles</label>
            <div class="select-multiple">
                @for (role of targetRoles; track role.id) {
                <label class="option">
                    <input type="checkbox" 
                           [(ngModel)]="role.isSelected"
                           [ngModelOptions]="{standalone: true}"
                           name="targetRole_{{role.id}}" />
                    <span>{{ role.name }}</span>
                </label>
                }
            </div>
        </div>
    </div>

    <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Skills Development</label>
        <div class="form-group search-group mb-3">
            <input type="text" placeholder="Search for skills..." class="form-input pl-9" [(ngModel)]="skillSearch" (keyup)="filterSkills()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500">
                <path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 100 13.5 6.75 6.75 0 000-13.5zM2.25 10.5a8.25 8.25 0 1114.59 5.28l4.69 4.69a.75.75 0 11-1.06 1.06l-4.69-4.69A8.25 8.25 0 012.25 10.5z" clip-rule="evenodd" />
            </svg>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <div class="skill-grid mb-4">
                    @for (skill of filteredSkills; track skill.id) {
                    <div class="skill-item" 
                         [class.selected]="isSkillSelected(skill.id)"
                         (click)="toggleSkill(skill)">
                        <div class="skill-icon" [style.backgroundColor]="skill.iconColor">
                            <svg *ngIf="skill.category === 'technical'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon">
                                <path fill-rule="evenodd" d="M14.447 3.027a.75.75 0 01.527.92l-4.5 16.5a.75.75 0 01-1.448-.394l4.5-16.5a.75.75 0 01.921-.526zM16.72 6.22a.75.75 0 011.06 0l5.25 5.25a.75.75 0 010 1.06l-5.25 5.25a.75.75 0 11-1.06-1.06L21.44 12l-4.72-4.72a.75.75 0 010-1.06zm-9.44 0a.75.75 0 010 1.06L2.56 12l4.72 4.72a.75.75 0 11-1.06 1.06L.97 12.53a.75.75 0 010-1.06l5.25-5.25a.75.75 0 011.06 0z" clip-rule="evenodd" />
                            </svg>
                            <svg *ngIf="skill.category === 'soft'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon">
                                <path d="M4.5 6.375a4.125 4.125 0 118.25 0 4.125 4.125 0 01-8.25 0zM14.25 8.625a3.375 3.375 0 116.75 0 3.375 3.375 0 01-6.75 0zM1.5 19.125a7.125 7.125 0 0114.25 0v.003l-.001.119a.75.75 0 01-.363.63 13.067 13.067 0 01-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 01-.364-.63l-.001-.122zM17.25 19.128l-.001.144a2.25 2.25 0 01-.233.96 10.088 10.088 0 005.06-1.01.75.75 0 00.42-.643 4.875 4.875 0 00-6.957-4.611 8.586 8.586 0 011.71 5.157v.003z" />
                            </svg>
                            <svg *ngIf="skill.category === 'domain'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon">
                                <path d="M11.584 2.376a.75.75 0 01.832 0l9 6a.75.75 0 11-.832 1.248L12 3.901 3.416 9.624a.75.75 0 01-.832-1.248l9-6z" />
                                <path fill-rule="evenodd" d="M20.25 10.332v9.918H21a.75.75 0 010 1.5H3a.75.75 0 010-1.5h.75v-9.918a.75.75 0 01.634-.74A49.109 49.109 0 0112 9c2.59 0 5.134.202 7.616.592a.75.75 0 01.634.74zm-7.5 2.418a.75.75 0 00-1.5 0v6.75a.75.75 0 001.5 0v-6.75zm3-.75a.75.75 0 01.75.75v6.75a.75.75 0 01-1.5 0v-6.75a.75.75 0 01.75-.75zM9 12.75a.75.75 0 00-1.5 0v6.75a.75.75 0 001.5 0v-6.75z" clip-rule="evenodd" />
                                <path d="M12 7.875a1.125 1.125 0 100-2.25 1.125 1.125 0 000 2.25z" />
                            </svg>
                        </div>
                        <div class="skill-name">{{skill.name}}</div>
                    </div>
                    }
                </div>
            </div>
            <div>
                <h4 class="text-sm font-medium text-gray-700 mb-2">Selected Skills ({{selectedSkills.length}})</h4>
                <div class="selected-skill-list">
                    @for (skill of selectedSkills; track skill.id) {
                    <div class="selected-skill-item">
                        <div class="skill-tag">{{skill.name}}</div>
                        <button class="remove-btn" (click)="removeSkill(skill)">Ã—</button>
                    </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <div class="grid md:grid-cols-3 gap-4">
        <div class="preference-group">
            <label class="block text-sm font-medium text-gray-700 mb-1">Time Commitment</label>
            <div class="preference-options">
                <label class="option-label" [class.active]="learningGoalMapping.timeCommitment === 'low'">
                    <input type="radio" name="timeCommitment" [(ngModel)]="learningGoalMapping.timeCommitment" value="low">
                    <div class="option-content">
                        <div>Low</div>
                        <div class="text-xs text-gray-500">1-2 hrs/week</div>
                    </div>
                </label>
                <label class="option-label" [class.active]="learningGoalMapping.timeCommitment === 'medium'">
                    <input type="radio" name="timeCommitment" [(ngModel)]="learningGoalMapping.timeCommitment" value="medium">
                    <div class="option-content">
                        <div>Medium</div>
                        <div class="text-xs text-gray-500">3-5 hrs/week</div>
                    </div>
                </label>
                <label class="option-label" [class.active]="learningGoalMapping.timeCommitment === 'high'">
                    <input type="radio" name="timeCommitment" [(ngModel)]="learningGoalMapping.timeCommitment" value="high">
                    <div class="option-content">
                        <div>High</div>
                        <div class="text-xs text-gray-500">6+ hrs/week</div>
                    </div>
                </label>
            </div>
        </div>

        <div class="preference-group">
            <label class="block text-sm font-medium text-gray-700 mb-1">Learning Style</label>
            <div class="preference-options">
                <label class="option-label" [class.active]="learningGoalMapping.learningStyle === 'visual'">
                    <input type="radio" name="learningStyle" [(ngModel)]="learningGoalMapping.learningStyle" value="visual">
                    <div class="option-content">
                        <div>Visual</div>
                        <div class="text-xs text-gray-500">Videos, diagrams</div>
                    </div>
                </label>
                <label class="option-label" [class.active]="learningGoalMapping.learningStyle === 'reading'">
                    <input type="radio" name="learningStyle" [(ngModel)]="learningGoalMapping.learningStyle" value="reading">
                    <div class="option-content">
                        <div>Reading</div>
                        <div class="text-xs text-gray-500">Articles, books</div>
                    </div>
                </label>
                <label class="option-label" [class.active]="learningGoalMapping.learningStyle === 'interactive'">
                    <input type="radio" name="learningStyle" [(ngModel)]="learningGoalMapping.learningStyle" value="interactive">
                    <div class="option-content">
                        <div>Interactive</div>
                        <div class="text-xs text-gray-500">Exercises, quizzes</div>
                    </div>
                </label>
            </div>
        </div>

        <div class="preference-group">
            <label class="block text-sm font-medium text-gray-700 mb-1">Difficulty Level</label>
            <div class="preference-options">
                <label class="option-label" [class.active]="learningGoalMapping.difficultyLevel === 'beginner'">
                    <input type="radio" name="difficultyLevel" [(ngModel)]="learningGoalMapping.difficultyLevel" value="beginner">
                    <div class="option-content">
                        <div>Beginner</div>
                        <div class="text-xs text-gray-500">Fundamentals</div>
                    </div>
                </label>
                <label class="option-label" [class.active]="learningGoalMapping.difficultyLevel === 'intermediate'">
                    <input type="radio" name="difficultyLevel" [(ngModel)]="learningGoalMapping.difficultyLevel" value="intermediate">
                    <div class="option-content">
                        <div>Intermediate</div>
                        <div class="text-xs text-gray-500">Some experience</div>
                    </div>
                </label>
                <label class="option-label" [class.active]="learningGoalMapping.difficultyLevel === 'advanced'">
                    <input type="radio" name="difficultyLevel" [(ngModel)]="learningGoalMapping.difficultyLevel" value="advanced">
                    <div class="option-content">
                        <div>Advanced</div>
                        <div class="text-xs text-gray-500">Expert level</div>
                    </div>
                </label>
            </div>
        </div>
    </div>

    <div class="mt-4 flex items-center">
        <div>
            @if (submitted && errorMessage != '') {
            <div class="valid-feedback text-red-700">
                {{ errorMessage }}
            </div>
            }

            @if (submitted && successMessage != '') {
            <div class="valid-feedback text-green-700">
                {{ successMessage }}
            </div>
            }
        </div>
        <div class="ml-auto flex gap-3">
            <button type="button" (click)="onPrevious.emit()" class="btn-secondary">
                Previous
            </button>
            <button type="button" (click)="saveLearningGoalMapping()" class="btn-primary">
                Next
            </button>
        </div>
    </div>
</div>